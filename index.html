<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAN 1 OKU BK POIN</title>
    <!-- Updated font from Inter to Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="login-icon">
                    <span class="material-icons-round">admin_panel_settings</span>
                </div>
                <h2>Admin Login</h2>
                <p>Masuk ke sistem manajemen poin siswa</p>
            </div>
            <div class="login-form">
                <div class="input-group">
                    <span class="material-icons-round">email</span>
                    <input type="email" id="email" placeholder="Email" required>
                </div>
                <div class="input-group">
                    <span class="material-icons-round">lock</span>
                    <input type="password" id="password" placeholder="Password" required>
                </div>
                <button id="loginBtn" class="btn-primary">
                    <span class="material-icons-round">login</span>
                    Masuk
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Section -->
    <div id="adminSection" class="admin-container" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">
                        <span class="material-icons-round">school</span>
                        <h1>Sistem Manajemen Poin</h1>
                    </div>
                </div>
                <div class="header-right">
                    <button id="logoutBtn" class="btn-logout">
                        <span class="material-icons-round">logout</span>
                        Keluar
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="admin-nav">
            <div class="nav-container">
                <button class="nav-item active" data-tab="students">
                    <span class="material-icons-round">people</span>
                    Daftar Siswa
                </button>
                <button class="nav-item" data-tab="add-case">
                    <span class="material-icons-round">add_circle</span>
                    Tambah Kasus
                </button>
                <button class="nav-item" data-tab="history">
                    <span class="material-icons-round">history</span>
                    Riwayat Kasus
                </button>
                <button class="nav-item" data-tab="warning-letter">
                    <span class="material-icons-round">description</span>
                    Surat Panggilan
                </button>
                <button class="nav-item" data-tab="manage">
                    <span class="material-icons-round">settings</span>
                    Kelola Data
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Students Tab -->
            <div id="students-tab" class="tab-content active">
                <div class="content-header">
                    <h2>Daftar Siswa</h2>
                    <div class="search-container">
                        <span class="material-icons-round">search</span>
                        <input type="text" id="studentSearchInput" placeholder="Cari nama siswa...">
                    </div>
                </div>
                <!-- Added responsive table wrapper for horizontal scrolling -->
                <div class="table-wrapper">
                    <div class="table-container">
                        <table class="modern-table">
                            <thead>
                                <tr>
                                    <th>UID</th>
                                    <th>Nama Siswa</th>
                                    <th>Poin</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Add Case Tab -->
            <div id="add-case-tab" class="tab-content">
                <div class="content-header">
                    <h2>Tambah Kasus Pelanggaran</h2>
                </div>
                <div class="form-container">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="caseUID">UID Siswa</label>
                            <input type="text" id="caseUID" readonly>
                        </div>
                        <div class="form-group">
                            <label for="studentName">Nama Siswa</label>
                            <input type="text" id="studentName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="initialPoints">Poin Awal</label>
                            <input type="number" id="initialPoints" readonly>
                        </div>
                        <div class="form-group">
                            <label for="caseReason">Jenis Pelanggaran</label>
                            <select id="caseReason" required>
                                <option value="">-- Pilih Jenis Pelanggaran --</option>
                                <option value="Terlambat">Terlambat</option>
                                <option value="Tidak Mengerjakan PR">Tidak Mengerjakan PR</option>
                                <option value="Berkelahi">Berkelahi</option>
                                <option value="Tidak Memakai Seragam">Tidak Memakai Seragam</option>
                                <option value="Mencontek">Mencontek</option>
                                <option value="Membolos">Membolos</option>
                                <option value="Lainnya">Lainnya</option>
                            </select>
                        </div>
                        <div class="form-group" id="otherReasonContainer" style="display: none;">
                            <label for="otherReason">Sebutkan Pelanggaran</label>
                            <input type="text" id="otherReason" placeholder="Sebutkan jenis pelanggaran">
                        </div>
                        <div class="form-group full-width">
                            <label for="caseDetails">Detail Pelanggaran</label>
                            <textarea id="caseDetails" rows="3" placeholder="Tambahkan detail pelanggaran"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="casePoints">Pengurangan Poin</label>
                            <input type="number" id="casePoints" placeholder="Pengurangan Poin" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="finalPoints">Poin Akhir</label>
                            <input type="number" id="finalPoints" readonly>
                        </div>
                    </div>
                    <button id="addCaseBtn" class="btn-primary">
                        <span class="material-icons-round">save</span>
                        Simpan Kasus
                    </button>
                </div>
            </div>

            <!-- History Tab -->
            <div id="history-tab" class="tab-content">
                <div class="content-header">
                    <h2>Riwayat Kasus</h2>
                    <div class="filter-container">
                        <div class="search-container">
                            <span class="material-icons-round">search</span>
                            <input type="text" id="caseSearchInput" placeholder="Cari nama siswa...">
                        </div>
                        <select id="caseFilterType">
                            <option value="">Semua Jenis Pelanggaran</option>
                            <option value="Terlambat">Terlambat</option>
                            <option value="Tidak Mengerjakan PR">Tidak Mengerjakan PR</option>
                            <option value="Berkelahi">Berkelahi</option>
                            <option value="Tidak Memakai Seragam">Tidak Memakai Seragam</option>
                            <option value="Mencontek">Mencontek</option>
                            <option value="Membolos">Membolos</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                    </div>
                </div>
                <div id="caseList" class="case-list"></div>
            </div>

            <!-- Warning Letter Tab -->
            <div id="warning-letter-tab" class="tab-content">
                <div class="content-header">
                    <h2>Surat Panggilan</h2>
                    <p class="subtitle">Generate surat panggilan berdasarkan poin pelanggaran siswa</p>
                </div>
                
                <div class="warning-info">
                    <h3>Ketentuan Surat Panggilan:</h3>
                    <ul>
                        <li>• SP 1: Poin pelanggaran > 30</li>
                        <li>• SP 2: Poin pelanggaran > 60</li>
                        <li>• SP 3: Poin pelanggaran > 90</li>
                    </ul>
                </div>

                <div class="settings-container">
                    <h3>Pengaturan Surat</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="schoolName">Nama Sekolah</label>
                            <input type="text" id="schoolName" value="SEKOLAH MENENGAH ATAS NEGERI 1">
                        </div>
                        <div class="form-group">
                            <label for="schoolAddress">Alamat Sekolah</label>
                            <input type="text" id="schoolAddress" value="Jl. Pendidikan No. 123, Kota Pendidikan">
                        </div>
                        <div class="form-group">
                            <label for="principalName">Nama Kepala Sekolah</label>
                            <input type="text" id="principalName" value="Drs. H. Ahmad Suryadi, M.Pd">
                        </div>
                        <div class="form-group">
                            <label for="principalNIP">NIP Kepala Sekolah</label>
                            <input type="text" id="principalNIP" value="196501011990031003">
                        </div>
                        <div class="form-group">
                            <label for="meetingDate">Tanggal Pertemuan</label>
                            <input type="date" id="meetingDate">
                        </div>
                        <div class="form-group">
                            <label for="meetingTime">Jam Pertemuan</label>
                            <input type="time" id="meetingTime" value="08:00">
                        </div>
                    </div>
                </div>

                <div class="search-container">
                    <span class="material-icons-round">search</span>
                    <input type="text" id="warningSearchInput" placeholder="Cari nama siswa...">
                </div>

                <!-- Added responsive table wrapper for horizontal scrolling -->
                <div class="table-wrapper">
                    <div class="table-container">
                        <table class="modern-table">
                            <thead>
                                <tr>
                                    <th>Nama Siswa</th>
                                    <th>UID</th>
                                    <th>Poin Saat Ini</th>
                                    <th>Poin Pelanggaran</th>
                                    <th>Jenis SP</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="warningTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Manage Tab -->
            <div id="manage-tab" class="tab-content">
                <div class="content-header">
                    <h2>Kelola Data Siswa</h2>
                    <div class="manage-actions">
                        <button id="resetPointsBtn" class="btn-warning">
                            <span class="material-icons-round">refresh</span>
                            Reset Semua Poin
                        </button>
                    </div>
                </div>
                
                <div class="search-container">
                    <span class="material-icons-round">search</span>
                    <input type="text" id="manageSearchInput" placeholder="Cari nama atau NISN...">
                </div>

                <!-- Added responsive table wrapper for horizontal scrolling -->
                <div class="table-wrapper">
                    <div class="table-container">
                        <table class="modern-table">
                            <thead>
                                <tr>
                                    <th>Siswa</th>
                                    <th>Poin</th>
                                    <th>Kasus Terakhir</th>
                                    <th>Poin Dikurangi</th>
                                    <th>Diperbarui Oleh</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="manageTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div id="dialogOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Pesan</h3>
                <button class="modal-close" id="modalClose">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="dialogMessage"></p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="modalOk">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="deleteModalOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="material-icons-round text-red">warning</span>
                <h3>Konfirmasi Hapus</h3>
                <button class="modal-close" id="deleteModalClose">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Apakah Anda yakin ingin menghapus data siswa <strong id="studentToDelete"></strong>?</p>
                <p class="text-red">Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data terkait siswa ini.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="deleteModalCancel">Batal</button>
                <button class="btn-danger" id="deleteModalConfirm">Hapus</button>
            </div>
        </div>
    </div>

    <!-- Reset Points Modal -->
    <div id="resetModalOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="material-icons-round text-blue">refresh</span>
                <h3>Reset Semua Poin</h3>
                <button class="modal-close" id="resetModalClose">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="resetValue">Reset poin ke nilai:</label>
                    <input type="number" id="resetValue" min="0" max="100" value="100">
                </div>
                <p>Apakah Anda yakin ingin mereset poin semua siswa ke nilai <strong id="resetValueDisplay">100</strong>?</p>
                <p class="text-warning">Tindakan ini akan mengubah poin semua siswa dan tidak dapat dibatalkan.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="resetModalCancel">Batal</button>
                <button class="btn-primary" id="resetModalConfirm">Reset Poin</button>
            </div>
        </div>
    </div>

    <!-- Hidden canvas for generating warning letter images -->
    <canvas id="warningLetterCanvas" style="display: none;" width="794" height="1123"></canvas>

    <script src="script.js" type="module"></script>
</body>
</html>
